<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Token Generator</title>
    <!-- Google Fonts: Noto Sans JP -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Noto+Sans+Mono:wght@400;700&display=swap" rel="stylesheet">
    <!-- DADS Design System Styles -->
    <link rel="stylesheet" href="./src/ui/styles/tokens.css">
    <link rel="stylesheet" href="./src/ui/styles/global.css">
    <link rel="stylesheet" href="./src/ui/styles/utilities.css">
    <link rel="stylesheet" href="./src/ui/styles/components.css">
    <link rel="stylesheet" href="./src/ui/styles/app-components.css">
</head>

<body>
    <div class="dads-layout dads-layout--full">
        <!-- Main Content -->
        <main class="dads-main">
            <!-- Header / View Switcher -->
            <header class="dads-main__header">
                <!-- タイトル -->
                <h1 class="dads-header__title">Color Token Generator</h1>

                <!-- ナビゲーション -->
                <nav class="dads-nav" aria-label="メインナビゲーション">
                    <button id="view-harmony" class="dads-button" data-size="lg" data-type="text" data-active="true">ハーモニー</button>
                    <button id="view-palette" class="dads-button" data-size="lg" data-type="text">パレット</button>
                    <button id="view-shades" class="dads-button" data-size="lg" data-type="text">シェード</button>
                    <button id="view-accessibility" class="dads-button" data-size="lg" data-type="text">アクセシビリティ</button>
                </nav>

                <!-- CVD Simulation Controls -->
                <div id="cvd-controls" class="dads-cvd-controls">
                    <div class="dads-header-controls">
                        <label class="dads-header-controls__label">色覚:</label>
                        <div id="cvdTypeButtons" class="dads-button-group">
                            <button data-cvd="normal" class="dads-button" data-size="sm" data-active="true">通常</button>
                            <button data-cvd="protanopia" class="dads-button" data-size="sm">P型</button>
                            <button data-cvd="deuteranopia" class="dads-button" data-size="sm">D型</button>
                            <button data-cvd="tritanopia" class="dads-button" data-size="sm">T型</button>
                            <button data-cvd="achromatopsia" class="dads-button" data-size="sm">全色盲</button>
                        </div>
                    </div>
                    <div id="cvd-score" class="dads-cvd-score">
                        <span class="dads-cvd-score__label">識別性スコア:</span>
                        <span id="cvd-score-value" class="dads-cvd-score__value">-</span>
                        <span id="cvd-score-grade" class="dads-cvd-score__grade">-</span>
                    </div>
                </div>

                <!-- Export Button -->
                <div id="export-controls" class="dads-header-controls" style="display: none;">
                    <button id="export-btn" class="dads-button" data-size="sm">
                        Export
                    </button>
                </div>
            </header>

            <!-- Content Area -->
            <div id="main-content" class="dads-main__content">
                <!-- ハーモニー選択ビュー（起点） -->
                <div id="harmony-view" class="dads-section">
                    <!-- ハーモニーカードがここにレンダリングされる -->
                </div>

                <!-- パレット/シェード/アクセシビリティビュー -->
                <div id="app" class="palette" hidden>
                    <!-- Palettes will be rendered here -->
                </div>
            </div>

            <!-- 状態通知用ライブリージョン -->
            <div id="live-region" class="dads-u-visually-hidden" aria-live="polite" aria-atomic="true"></div>
        </main>
    </div>

    <!-- Hidden state storage -->
    <input type="hidden" id="harmony" value="complementary">
    <input type="hidden" id="keyColors" value="#3366cc">

    <!-- ダミー要素（demo.ts互換用） -->
    <div id="palette-list" hidden></div>

    <!-- Export Modal -->
    <dialog id="export-dialog" class="dads-dialog">
        <h3 class="dads-dialog__title">Export</h3>
        <div class="dads-dialog__body">
            <div class="dads-form-field">
                <label class="dads-label">Format</label>
                <div id="export-format-buttons" class="dads-button-group">
                    <button data-format="css" class="dads-button" data-size="sm" data-active="true">CSS</button>
                    <button data-format="tailwind" class="dads-button" data-size="sm">Tailwind</button>
                    <button data-format="json" class="dads-button" data-size="sm">JSON</button>
                </div>
            </div>
            <textarea id="export-area" class="dads-input dads-dialog__textarea" readonly></textarea>
        </div>
        <div class="dads-dialog__footer">
            <button id="export-copy-btn" class="dads-button" data-variant="primary">Copy</button>
            <button id="export-download-btn" class="dads-button">Download</button>
            <button onclick="document.getElementById('export-dialog').close()" class="dads-button">Close</button>
        </div>
    </dialog>

    <!-- Color Detail Drawer -->
    <dialog id="color-detail-dialog" class="dads-dialog dads-dialog--drawer">
        <div class="dads-drawer__layout">
            <!-- Mini Scale (Fixed at top edge) -->
            <div id="detail-mini-scale" class="dads-mini-scale">
                <!-- Mini swatches will be populated here -->
            </div>

            <!-- Header Info (Fixed below scale) -->
            <div class="dads-dialog__header">
                <div class="dads-drawer__header-content">
                    <div id="detail-swatch" class="dads-drawer__swatch"></div>
                    <div class="dads-drawer__info">
                        <h2 id="detail-chroma-name" class="dads-drawer__chroma-name"></h2>
                        <div id="detail-token-name" class="dads-drawer__token-name"></div>
                        <div class="dads-drawer__meta">
                            <code id="detail-hex" class="dads-text-mono"></code>
                            <span id="detail-lightness" class="dads-drawer__lightness"></span>
                        </div>
                    </div>
                    <div class="dads-drawer__close">
                         <form method="dialog">
                            <button class="dads-drawer__close-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Main Content (Scrollable) -->
            <div class="dads-dialog__body">
                <div class="dads-drawer__grid">
                    <!-- Col 1: Contrast -->
                    <div class="dads-drawer__contrast-col">
                        <h3 class="dads-drawer__section-title">コントラスト</h3>
                        <div class="dads-grid" data-columns="2">
                            <!-- White Card -->
                            <div id="detail-white-card" class="dads-contrast-card" data-bg="white">
                                <div class="dads-contrast-card__header">
                                    <span class="dads-contrast-card__label">白に対するコントラスト</span>
                                    <span id="detail-white-badge" class="dads-badge">-</span>
                                </div>
                                <div class="dads-contrast-card__value">
                                    <span id="detail-white-ratio" class="dads-contrast-card__ratio">-</span>
                                    <span class="dads-contrast-card__unit">:1</span>
                                </div>
                                <div id="detail-white-preview" class="dads-contrast-card__preview">
                                    吾輩は猫である。名前はまだ無い。どこで生れたかとんと見当がつかぬ。
                                </div>
                                <div id="detail-white-preview-large" class="dads-contrast-card__preview--large">
                                    大きな文字での見え方を確認します
                                </div>
                                <div id="detail-white-fail-icon" class="dads-contrast-card__fail">
                                    ⚠️ コントラスト不足
                                </div>
                            </div>

                            <!-- Black Card -->
                            <div id="detail-black-card" class="dads-contrast-card" data-bg="black">
                                <div class="dads-contrast-card__header">
                                    <span class="dads-contrast-card__label">黒に対するコントラスト</span>
                                    <span id="detail-black-badge" class="dads-badge">-</span>
                                </div>
                                <div class="dads-contrast-card__value">
                                    <span id="detail-black-ratio" class="dads-contrast-card__ratio">-</span>
                                    <span class="dads-contrast-card__unit">:1</span>
                                </div>
                                <div id="detail-black-preview" class="dads-contrast-card__preview">
                                    吾輩は猫である。名前はまだ無い。どこで生れたかとんと見当がつかぬ。
                                </div>
                                <div id="detail-black-preview-large" class="dads-contrast-card__preview--large">
                                    大きな文字での見え方を確認します
                                </div>
                                <div id="detail-black-fail-icon" class="dads-contrast-card__fail">
                                    ⚠️ コントラスト不足
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Col 2: Color Tuner & Actions -->
                    <div class="dads-drawer__tuner-col">
                         <h3 class="dads-drawer__section-title">カラーチューナー</h3>
                         <p class="dads-drawer__tuner-help">
                            ドラッグ: ↔ 色相 (Hue)<br>
                            Shift + ドラッグ: 精密操作
                         </p>
                         <!-- Infinite Scrubber -->
                        <div class="dads-scrubber">
                             <canvas id="tuner-scrubber"></canvas>
                             <!-- Center Indicator -->
                             <div class="dads-scrubber__indicator"></div>
                        </div>

                         <!-- Actions -->
                         <div class="dads-dialog__actions">
                            <button id="detail-reset-btn" class="dads-button">
                                リセット
                            </button>
                            <button id="detail-save-btn" class="dads-button" data-variant="primary">
                                保存
                            </button>
                         </div>
                    </div>
                </div>
            </div>
        </div>
    </dialog>

    <script type="module" src="./dist/index.js"></script>
</body>

</html>
