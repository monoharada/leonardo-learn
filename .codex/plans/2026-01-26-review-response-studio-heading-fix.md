# studio-heading-fix: レビュー対応プラン

## 目標
- レビュー指摘（スコープ記述の齟齬/余白調整の堅牢性）を解消する
- 意図した見た目（タイポ・余白・ヒエラルキー）を維持する
- `bun run lint` / `bun run type-check` / `bun test` をグリーンのままにする

## 背景
- `palette-preview.ts` で DADS プレビューの見出し構造・タイポを改善し、巨大なマークアップ生成を分割した
- `studio-view.ts` の a11y 要約見出しをセマンティックに変更し、集計ロジックを単一ソース化した
- 追加の見た目調整（shoulder と heading の間隔/本文の最小 16px 化）を行った
- レビューで以下が論点になり得る：
  - `.codex/plans/...` の「5ファイル限定」記述と実際の差分の不一致
  - `margin-top: -0.15em` のような負のマージン調整の堅牢性・スコープ

## スコープ
- やること：
  - `.codex/plans/...` のスコープ/受入基準の記述を実態と整合させる（Planの運用として PR に含める）
  - shoulder と heading 間隔の調整を、影響範囲が読める形にする（スコープ付け/調整方式の見直し）
  - 回帰がないことをテストと目視で確認する
- やらないこと：
  - 依存追加、広域リネーム、大規模リファクタ、無関係ファイルへの波及
  - 見出しレベルの再設計（「桜川市 オンライン窓口」は `h2` を維持）

## 前提 / 制約
- 余白調整は「プレビュー専用コンテキスト」に閉じるのが安全（例：`dads-preview--dads-html`）
- “改善” より “レビュー懸念の解消” を優先し、差分は最小限にする

## 変更内容（案）
### データ / バックエンド
- 該当なし

### UI / UX
- 該当なし（見出しレベルは現状維持）

### その他（Docs/Marketing/Infra など）
- `.codex/plans/2026-01-26-code-simplify-uncommitted-5-files.md`
  - 受入基準の「5ファイル限定」を、Plan文書を含む運用と矛盾しない表現に修正
- `src/ui/styles/dads-html-preview.css`
  - shoulder/heading 間隔の調整ルールをプレビューにスコープして副作用を抑える

## 受入基準
- [ ] `.codex/plans/2026-01-26-code-simplify-uncommitted-5-files.md` のスコープ/受入基準が差分実態と矛盾しない
- [ ] shoulder/heading の余白調整がプレビューに閉じ、他画面に影響しない（または影響が意図通りに説明可能）
- [ ] 見た目が現状意図から崩れていない（Preview/Studio の該当箇所を目視確認）
- [ ] `bun run lint` が通る
- [ ] `bun run type-check` が通る
- [ ] `bun test` が通る

## リスク / エッジケース
- 負のマージン調整はフォント差やブラウザ差で詰まり具合が変わる可能性がある
- `.codex/plans` の扱いがチーム運用とズレると差し戻しになる

## 作業項目（Action items）
1. planファイルを PR に含める前提で、既存Plan文書の記述齟齬を修正（完了条件: “5ファイル” 等の齟齬が解消される）
2. shoulder/heading 間隔調整をプレビューへスコープ（完了条件: 影響範囲がプレビューに閉じる/説明可能になる）
3. `bun run lint` を実行して静的品質を確認（完了条件: エラー・警告 0）
4. `bun run type-check` を実行して型の健全性を確認（完了条件: エラー 0）
5. `bun test` を実行して回帰がないことを確認（完了条件: fail 0）
6. Preview と Studio の該当箇所を目視でスモーク確認（完了条件: 見出し/余白/本文サイズが意図通り）

## テスト計画
- `bun run lint`
- `bun run type-check`
- `bun test`
- 目視: Palette preview の DADS HTML プレビューと Studio の a11y 要約見出し周り（余白・ヒエラルキー）

## オープンクエスチョン
- なし（決定事項: planファイルはPRに含める / 「桜川市 オンライン窓口」は `h2` を維持）

